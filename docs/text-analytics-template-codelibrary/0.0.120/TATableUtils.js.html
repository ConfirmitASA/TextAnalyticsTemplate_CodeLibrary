<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>TATableUtils.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Config.html">Config</a><ul class='methods'><li data-type='method'><a href="Config.html#.GetTALibrary">GetTALibrary</a></li><li data-type='method'><a href="Config.html#.SetTaLibrary">SetTaLibrary</a></li></ul></li><li><a href="FilterComponents.html">FilterComponents</a><ul class='methods'><li data-type='method'><a href="FilterComponents.html#ClearFilters">ClearFilters</a></li><li data-type='method'><a href="FilterComponents.html#GetAllAnsweredFilterCodes">GetAllAnsweredFilterCodes</a></li><li data-type='method'><a href="FilterComponents.html#GetFilterInformation">GetFilterInformation</a></li><li data-type='method'><a href="FilterComponents.html#GetFilterQuestion">GetFilterQuestion</a></li><li data-type='method'><a href="FilterComponents.html#GetFilterTitle">GetFilterTitle</a></li><li data-type='method'><a href="FilterComponents.html#GetGlobalsFilterExpression">GetGlobalsFilterExpression</a></li></ul></li><li><a href="Filters.html">Filters</a><ul class='methods'><li data-type='method'><a href="Filters.html#.DateFilter">DateFilter</a></li><li data-type='method'><a href="Filters.html#.FilterPageFilter">FilterPageFilter</a></li><li data-type='method'><a href="Filters.html#.TAHitlistSentimentFilter">TAHitlistSentimentFilter</a></li><li data-type='method'><a href="Filters.html#.TASelectedCategoryFilter">TASelectedCategoryFilter</a></li></ul></li><li><a href="Hierarchy.html">Hierarchy</a><ul class='methods'><li data-type='method'><a href="Hierarchy.html#_createFlatEntry">_createFlatEntry</a></li><li data-type='method'><a href="Hierarchy.html#_generateFlatList">_generateFlatList</a></li><li data-type='method'><a href="Hierarchy.html#_getDataTable">_getDataTable</a></li><li data-type='method'><a href="Hierarchy.html#_mergeOptions">_mergeOptions</a></li><li data-type='method'><a href="Hierarchy.html#_setupHierarchy">_setupHierarchy</a></li><li data-type='method'><a href="Hierarchy.html#GetFlatArray">GetFlatArray</a></li><li data-type='method'><a href="Hierarchy.html#GetHierarchyArray">GetHierarchyArray</a></li><li data-type='method'><a href="Hierarchy.html#GetLevelArray">GetLevelArray</a></li><li data-type='method'><a href="Hierarchy.html#GetLevelsCount">GetLevelsCount</a></li><li data-type='method'><a href="Hierarchy.html#GetObjectById">GetObjectById</a></li></ul></li><li><a href="JSON.html">JSON</a><ul class='methods'><li data-type='method'><a href="JSON.html#._escapeEntities">_escapeEntities</a></li><li data-type='method'><a href="JSON.html#.print">print</a></li><li data-type='method'><a href="JSON.html#.stringify">stringify</a></li></ul></li><li><a href="Page_comments.html">Page_comments</a><ul class='methods'><li data-type='method'><a href="Page_comments.html#.Hide">Hide</a></li><li data-type='method'><a href="Page_comments.html#.htlComments_Hide">htlComments_Hide</a></li><li data-type='method'><a href="Page_comments.html#.htlComments_Render">htlComments_Render</a></li><li data-type='method'><a href="Page_comments.html#.lstAttribute_Hide">lstAttribute_Hide</a></li><li data-type='method'><a href="Page_comments.html#.lstCategory_Hide">lstCategory_Hide</a></li><li data-type='method'><a href="Page_comments.html#.lstSubCategory_Hide">lstSubCategory_Hide</a></li><li data-type='method'><a href="Page_comments.html#.Render">Render</a></li><li data-type='method'><a href="Page_comments.html#.txtAttribute_Hide">txtAttribute_Hide</a></li><li data-type='method'><a href="Page_comments.html#.txtAttribute_Render">txtAttribute_Render</a></li><li data-type='method'><a href="Page_comments.html#.txtAttribute_Render">txtAttribute_Render</a></li><li data-type='method'><a href="Page_comments.html#.txtCategory_Hide">txtCategory_Hide</a></li><li data-type='method'><a href="Page_comments.html#.txtCategory_Render">txtCategory_Render</a></li><li data-type='method'><a href="Page_comments.html#.txtCommentsScript_Hide">txtCommentsScript_Hide</a></li><li data-type='method'><a href="Page_comments.html#.txtCommentsScript_Render">txtCommentsScript_Render</a></li><li data-type='method'><a href="Page_comments.html#.txtSentiment_Hide">txtSentiment_Hide</a></li><li data-type='method'><a href="Page_comments.html#.txtSubCategory_Hide">txtSubCategory_Hide</a></li><li data-type='method'><a href="Page_comments.html#.txtSubCategory_Render">txtSubCategory_Render</a></li></ul></li><li><a href="Page_dashboard.html">Page_dashboard</a><ul class='methods'><li data-type='method'><a href="Page_dashboard.html#._renderTblMostChanged">_renderTblMostChanged</a></li><li data-type='method'><a href="Page_dashboard.html#._renderTblMostSentiment">_renderTblMostSentiment</a></li><li data-type='method'><a href="Page_dashboard.html#.Hide">Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.Render">Render</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostDeclined_Hide">tblMostDeclined_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostDeclined_Render">tblMostDeclined_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostImproved_Hide">tblMostImproved_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostImproved_Render">tblMostImproved_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostNegative_Hide">tblMostNegative_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostNegative_Render">tblMostNegative_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostPositive_Hide">tblMostPositive_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.tblMostPositive_Render">tblMostPositive_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.tblThemeDistribution_Hide">tblThemeDistribution_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.tblThemeDistribution_Render">tblThemeDistribution_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtComparePeriods_Hide">txtComparePeriods_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtComparePeriods_Render">txtComparePeriods_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtLevel_Hide">txtLevel_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtLevel_Render">txtLevel_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostChangedInfo_Hide">txtMostChangedInfo_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostChangedInfo_Render">txtMostChangedInfo_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostDeclined_Hide">txtMostDeclined_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostDeclined_Render">txtMostDeclined_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostImproved_Hide">txtMostImproved_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostImproved_Render">txtMostImproved_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostNegative_Hide">txtMostNegative_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostNegative_Render">txtMostNegative_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostPositive_Hide">txtMostPositive_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtMostPositive_Render">txtMostPositive_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtThemeDistribution_Hide">txtThemeDistribution_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtThemeDistribution_Render">txtThemeDistribution_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtThemeDistributionScript_Hide">txtThemeDistributionScript_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtThemeDistributionScript_Render">txtThemeDistributionScript_Render</a></li><li data-type='method'><a href="Page_dashboard.html#.txtViewSentiment_Hide">txtViewSentiment_Hide</a></li><li data-type='method'><a href="Page_dashboard.html#.txtViewSentiment_Render">txtViewSentiment_Render</a></li></ul></li><li><a href="Page_detailed_analysis.html">Page_detailed_analysis</a><ul class='methods'><li data-type='method'><a href="Page_detailed_analysis.html#._buildTATiles">_buildTATiles</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.Hide">Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.Render">Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblDetailedAnalysis_Hide">tblDetailedAnalysis_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblDetailedAnalysis_Render">tblDetailedAnalysis_Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblMostPositive_RendertblNeutralCommentsTile_Render">tblMostPositive_RendertblNeutralCommentsTile_Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblNegativeCommentsTile_Hide">tblNegativeCommentsTile_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblNegativeCommentsTile_Render">tblNegativeCommentsTile_Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblNeutralCommentsTile_Hide">tblNeutralCommentsTile_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblPositiveCommentsTile_Hide">tblPositiveCommentsTile_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblPositiveCommentsTile_Render">tblPositiveCommentsTile_Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblTotalCommentsTile_Hide">tblTotalCommentsTile_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.tblTotalCommentsTile_Render">tblTotalCommentsTile_Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.txtCategory_Hide">txtCategory_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.txtCategory_Render">txtCategory_Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.txtDetailedAnalysisScript_Hide">txtDetailedAnalysisScript_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.txtDetailedAnalysisScript_Render">txtDetailedAnalysisScript_Render</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.txtViewBy_Hide">txtViewBy_Hide</a></li><li data-type='method'><a href="Page_detailed_analysis.html#.txtViewBy_Render">txtViewBy_Render</a></li></ul></li><li><a href="Page_filters.html">Page_filters</a><ul class='methods'><li data-type='method'><a href="Page_filters.html#.btnClearFilters_Hide">btnClearFilters_Hide</a></li><li data-type='method'><a href="Page_filters.html#.btnClearFilters_Render">btnClearFilters_Render</a></li><li data-type='method'><a href="Page_filters.html#.btnSave_Hide">btnSave_Hide</a></li><li data-type='method'><a href="Page_filters.html#.btnSave_Render">btnSave_Render</a></li><li data-type='method'><a href="Page_filters.html#.btnSaveReturn_Hide">btnSaveReturn_Hide</a></li><li data-type='method'><a href="Page_filters.html#.btnSaveReturn_Render">btnSaveReturn_Render</a></li><li data-type='method'><a href="Page_filters.html#.Hide">Hide</a></li><li data-type='method'><a href="Page_filters.html#.lstFilterList_Hide">lstFilterList_Hide</a></li><li data-type='method'><a href="Page_filters.html#.Render">Render</a></li><li data-type='method'><a href="Page_filters.html#.txtFilterTitle_Hide">txtFilterTitle_Hide</a></li><li data-type='method'><a href="Page_filters.html#.txtFilterTitle_Render">txtFilterTitle_Render</a></li></ul></li><li><a href="PageMaster.html">PageMaster</a><ul class='methods'><li data-type='method'><a href="PageMaster.html#.ClearFilters_Hide">ClearFilters_Hide</a></li><li data-type='method'><a href="PageMaster.html#.ClearFilters_Render">ClearFilters_Render</a></li><li data-type='method'><a href="PageMaster.html#.Filters_Hide">Filters_Hide</a></li><li data-type='method'><a href="PageMaster.html#.Filters_Render">Filters_Render</a></li><li data-type='method'><a href="PageMaster.html#.FilterSummary_Render">FilterSummary_Render</a></li></ul></li><li><a href="Parameters.html">Parameters</a><ul class='methods'><li data-type='method'><a href="Parameters.html#.FILTER_Domain">FILTER_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_ATTRIBUTES_SINGLE_Domain">TA_ATTRIBUTES_SINGLE_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_ATTRIBUTES_SINGLE_Mask">TA_ATTRIBUTES_SINGLE_Mask</a></li><li data-type='method'><a href="Parameters.html#.TA_COMPARE_PERIODS_Domain">TA_COMPARE_PERIODS_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_DISTRIBUTION_TOGGLE_Domain">TA_DISTRIBUTION_TOGGLE_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_HIDE_EMPTY_ROWS_Domain">TA_HIDE_EMPTY_ROWS_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_LEVEL_Domain">TA_LEVEL_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_SUB_CATEGORIES_SINGLE_Domain">TA_SUB_CATEGORIES_SINGLE_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_SUB_CATEGORIES_SINGLE_Mask">TA_SUB_CATEGORIES_SINGLE_Mask</a></li><li data-type='method'><a href="Parameters.html#.TA_TOP_CATEGORIES_SINGLE_Domain">TA_TOP_CATEGORIES_SINGLE_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_VIEW_BY_Domain">TA_VIEW_BY_Domain</a></li><li data-type='method'><a href="Parameters.html#.TA_VIEW_SENTIMENT_Domain">TA_VIEW_SENTIMENT_Domain</a></li></ul></li><li><a href="ParameterUtilities.html">ParameterUtilities</a><ul class='methods'><li data-type='method'><a href="ParameterUtilities.html#GetCheckedValues">GetCheckedValues</a></li><li data-type='method'><a href="ParameterUtilities.html#GetCheckedValues">GetCheckedValues</a></li><li data-type='method'><a href="ParameterUtilities.html#GetCheckedValues">GetCheckedValues</a></li><li data-type='method'><a href="ParameterUtilities.html#LoadParameterValues">LoadParameterValues</a></li></ul></li><li><a href="ReportMaster.html">ReportMaster</a><ul class='methods'><li data-type='method'><a href="ReportMaster.html#.btnApplyDateFilter_Hide">btnApplyDateFilter_Hide</a></li><li data-type='method'><a href="ReportMaster.html#.btnApplyDateFilter_Render">btnApplyDateFilter_Render</a></li><li data-type='method'><a href="ReportMaster.html#.btnClearDateFilter_Hide">btnClearDateFilter_Hide</a></li><li data-type='method'><a href="ReportMaster.html#.btnClearDateFilter_Render">btnClearDateFilter_Render</a></li><li data-type='method'><a href="ReportMaster.html#.CustomerLogo_Hide">CustomerLogo_Hide</a></li><li data-type='method'><a href="ReportMaster.html#.CustomerLogo_Render">CustomerLogo_Render</a></li></ul></li><li><a href="TADetailedAnalysisTable.html">TADetailedAnalysisTable</a><ul class='methods'><li data-type='method'><a href="TADetailedAnalysisTable.html#_addChartColumn">_addChartColumn</a></li><li data-type='method'><a href="TADetailedAnalysisTable.html#_getColumnFormulaExpression">_getColumnFormulaExpression</a></li><li data-type='method'><a href="TADetailedAnalysisTable.html#_getColumnheadersExpression">_getColumnheadersExpression</a></li><li data-type='method'><a href="TADetailedAnalysisTable.html#_getRowheadersExpression">_getRowheadersExpression</a></li><li data-type='method'><a href="TADetailedAnalysisTable.html#_render">_render</a></li><li data-type='method'><a href="TADetailedAnalysisTable.html#_setupConditionalFormatting">_setupConditionalFormatting</a></li><li data-type='method'><a href="TADetailedAnalysisTable.html#_setupTableDistribution">_setupTableDistribution</a></li><li data-type='method'><a href="TADetailedAnalysisTable.html#GetTATableUtils">GetTATableUtils</a></li></ul></li><li><a href="TAFilters.html">TAFilters</a><ul class='methods'><li data-type='method'><a href="TAFilters.html#GetDateFilterExpression">GetDateFilterExpression</a></li><li data-type='method'><a href="TAFilters.html#GetSelectedCategoryFilterExpression">GetSelectedCategoryFilterExpression</a></li><li data-type='method'><a href="TAFilters.html#GetSentimentFilterExpression">GetSentimentFilterExpression</a></li></ul></li><li><a href="TAFolder.html">TAFolder</a><ul class='methods'><li data-type='method'><a href="TAFolder.html#GetDatasourceId">GetDatasourceId</a></li><li data-type='method'><a href="TAFolder.html#GetHierarchy">GetHierarchy</a></li><li data-type='method'><a href="TAFolder.html#GetHitlistColumns">GetHitlistColumns</a></li><li data-type='method'><a href="TAFolder.html#GetId">GetId</a></li><li data-type='method'><a href="TAFolder.html#GetQuestionId">GetQuestionId</a></li><li data-type='method'><a href="TAFolder.html#GetTimeVariableId">GetTimeVariableId</a></li><li data-type='method'><a href="TAFolder.html#GetViewByVariables">GetViewByVariables</a></li></ul></li><li><a href="TAHelper.html">TAHelper</a><ul class='methods'><li data-type='method'><a href="TAHelper.html#.GetConfiguredVariables">GetConfiguredVariables</a></li><li data-type='method'><a href="TAHelper.html#.GetGlobals">GetGlobals</a></li><li data-type='method'><a href="TAHelper.html#.GetSelectedCategory">GetSelectedCategory</a></li><li data-type='method'><a href="TAHelper.html#.GetSelfName">GetSelfName</a></li><li data-type='method'><a href="TAHelper.html#.SetLastVisitedPage">SetLastVisitedPage</a></li></ul></li><li><a href="TAHitlistUtils.html">TAHitlistUtils</a><ul class='methods'><li data-type='method'><a href="TAHitlistUtils.html#AddColumn">AddColumn</a></li><li data-type='method'><a href="TAHitlistUtils.html#AddConfiguredColumns">AddConfiguredColumns</a></li><li data-type='method'><a href="TAHitlistUtils.html#AddTAColumn">AddTAColumn</a></li></ul></li><li><a href="TALibrary.html">TALibrary</a><ul class='methods'><li data-type='method'><a href="TALibrary.html#GetFiltersQuestions">GetFiltersQuestions</a></li><li data-type='method'><a href="TALibrary.html#GetFolderById">GetFolderById</a></li><li data-type='method'><a href="TALibrary.html#GetFolders">GetFolders</a></li><li data-type='method'><a href="TALibrary.html#SetCurrentFolder">SetCurrentFolder</a></li></ul></li><li><a href="TAMasks.html">TAMasks</a><ul class='methods'><li data-type='method'><a href="TAMasks.html#GetAllChildrenMask">GetAllChildrenMask</a></li><li data-type='method'><a href="TAMasks.html#GetCategoriesMask">GetCategoriesMask</a></li><li data-type='method'><a href="TAMasks.html#GetChildrenMask">GetChildrenMask</a></li></ul></li><li><a href="TAParameters.html">TAParameters</a><ul class='methods'><li data-type='method'><a href="TAParameters.html#_addEmptyValue">_addEmptyValue</a></li><li data-type='method'><a href="TAParameters.html#ClearSubcategoriesParameters">ClearSubcategoriesParameters</a></li><li data-type='method'><a href="TAParameters.html#MaskSelectedCategoryChildren">MaskSelectedCategoryChildren</a></li><li data-type='method'><a href="TAParameters.html#RenderFoldersParameter">RenderFoldersParameter</a></li><li data-type='method'><a href="TAParameters.html#RenderLevelCategoriesParameter">RenderLevelCategoriesParameter</a></li><li data-type='method'><a href="TAParameters.html#RenderLevelsParameter">RenderLevelsParameter</a></li><li data-type='method'><a href="TAParameters.html#RenderViewByParameter">RenderViewByParameter</a></li></ul></li><li><a href="TATableData.html">TATableData</a><ul class='methods'><li data-type='method'><a href="TATableData.html#GetBlocks">GetBlocks</a></li><li data-type='method'><a href="TATableData.html#GetTableRowHeaders">GetTableRowHeaders</a></li></ul></li><li><a href="TATableUtils.html">TATableUtils</a><ul class='methods'><li data-type='method'><a href="TATableUtils.html#_getSumOfCells">_getSumOfCells</a></li><li data-type='method'><a href="TATableUtils.html#AddClasses">AddClasses</a></li><li data-type='method'><a href="TATableUtils.html#CreateTableFromExpression">CreateTableFromExpression</a></li><li data-type='method'><a href="TATableUtils.html#GetCategoriesExpression">GetCategoriesExpression</a></li><li data-type='method'><a href="TATableUtils.html#GetCategoriesHeader">GetCategoriesHeader</a></li><li data-type='method'><a href="TATableUtils.html#GetChartHeader">GetChartHeader</a></li><li data-type='method'><a href="TATableUtils.html#GetTAQuestionExpression">GetTAQuestionExpression</a></li><li data-type='method'><a href="TATableUtils.html#GetTimePeriodHeader">GetTimePeriodHeader</a></li><li data-type='method'><a href="TATableUtils.html#SetupConditionalFormatting">SetupConditionalFormatting</a></li><li data-type='method'><a href="TATableUtils.html#SetupDrilldown">SetupDrilldown</a></li><li data-type='method'><a href="TATableUtils.html#SetupHideEmptyRows">SetupHideEmptyRows</a></li><li data-type='method'><a href="TATableUtils.html#SetupRowsTableSorting">SetupRowsTableSorting</a></li></ul></li><li><a href="TAThemeDistributionTable.html">TAThemeDistributionTable</a><ul class='methods'><li data-type='method'><a href="TAThemeDistributionTable.html#_addTimeSeriesColum">_addTimeSeriesColum</a></li><li data-type='method'><a href="TAThemeDistributionTable.html#_getCountsColumn">_getCountsColumn</a></li><li data-type='method'><a href="TAThemeDistributionTable.html#_getHeaderStatistics">_getHeaderStatistics</a></li><li data-type='method'><a href="TAThemeDistributionTable.html#_render">_render</a></li><li data-type='method'><a href="TAThemeDistributionTable.html#_setupConditionalFormatting%257D">_setupConditionalFormatting}</a></li><li data-type='method'><a href="TAThemeDistributionTable.html#GetTATableUtils">GetTATableUtils</a></li></ul></li><li><a href="TATiles.html">TATiles</a><ul class='methods'><li data-type='method'><a href="TATiles.html#_render">_render</a></li><li data-type='method'><a href="TATiles.html#GetTATableUtils">GetTATableUtils</a></li></ul></li><li><a href="TATopChangedTable.html">TATopChangedTable</a><ul class='methods'><li data-type='method'><a href="TATopChangedTable.html#_addChartColumn">_addChartColumn</a></li><li data-type='method'><a href="TATopChangedTable.html#_addDifferenceColumn">_addDifferenceColumn</a></li><li data-type='method'><a href="TATopChangedTable.html#_addTimeSeriesColumn">_addTimeSeriesColumn</a></li><li data-type='method'><a href="TATopChangedTable.html#_render">_render</a></li><li data-type='method'><a href="TATopChangedTable.html#_setupSorting">_setupSorting</a></li><li data-type='method'><a href="TATopChangedTable.html#GetTATableUtils">GetTATableUtils</a></li></ul></li><li><a href="TATopSentimentTable.html">TATopSentimentTable</a><ul class='methods'><li data-type='method'><a href="TATopSentimentTable.html#_addChartColum">_addChartColum</a></li><li data-type='method'><a href="TATopSentimentTable.html#_render">_render</a></li><li data-type='method'><a href="TATopSentimentTable.html#_setupSorting">_setupSorting</a></li><li data-type='method'><a href="TATopSentimentTable.html#GetTATableUtils">GetTATableUtils</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">TATableUtils.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @class TATableUtils
 * @classdesc Class to work with tables using Text Analytics variables
 *
 * @constructs TATableUtils
 * @param {Object} globals - object of global report variables {pageContext: this.pageContext, report: report, user: user, state: state, confirmit: confirmit, log: log}
 * @param  {TAFolder} folder
 * @param {Table} table
 */
class TATableUtils{
    private var _globals;
    private var _folder: TAFolder;
    private var _table: Table;

    function TATableUtils(globals, folder, table){
        _globals = globals;
        _folder = folder;
        _table = table;
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function SetupRowsTableSorting
     * @param {Boolean} directionAscending
     * @param {Byte} position
     * @param {Number} topN
     */
    function SetupRowsTableSorting(directionAscending: Boolean, position: Byte, topN){
        _table.Sorting.Rows.Enabled = true;
        _table.Sorting.Rows.SortByType = TableSortByType.Position;
        _table.Sorting.Rows.Direction = directionAscending ? TableSortDirection.Ascending : TableSortDirection.Descending;
        _table.Sorting.Rows.Position = position;
        _table.Sorting.Rows.PositionDirection =  TableSortByPositionType.FromStart;
        _table.Sorting.Rows.TopN = topN ? topN : 0;
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function SetupConditionalFormatting
     * @param {Object[]} conditions - array of objects like { expression: 'cellv(col,row)&lt;(-1)', style: 'negative'}
     * @param {String} name
     * @param {Object} applyTo - define area in object like {axis: Area.Columns, direction: Area.Left, indexes: "3"}
     */
    function SetupConditionalFormatting(conditions, name, applyTo){
        var formatter : ConditionalFormatting = _table.ConditionalFormatting;

        var area : Area = new Area();

        area.Name = name;
        area.ApplyTo(applyTo.axis, applyTo.direction, applyTo.indexes);

        for(var i = 0; i&lt; conditions.length; i++){
            var condition: Condition = new Condition();
            condition.Expression = conditions[i].expression;
            condition.Style = conditions[i].style;
            area.AddCondition(condition);
        }

        formatter.AddArea(area);

        _table.ConditionalFormatting = formatter;
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function SetupDrilldown
     * @param {String} parameterId
     * @param {String} pageIDs
     */
    function SetupDrilldown(parameterId: String, pageIDs){
        _table.Drilling.Rows.Enabled = true;
        _table.Drilling.Rows.Type = DrilldownType.SetParameter;
        _table.Drilling.Rows.ParameterID = parameterId;
        _table.Drilling.Rows.TargetPages = pageIDs;
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function SetupHideEmptyRows
     * @param {Boolean} parameterId
     */
    function SetupHideEmptyRows(hideEmptyRows){
        _table.RemoveEmptyHeaders.Rows = hideEmptyRows;
    }

    /**
    * @memberof TATableUtils
    * @instance
    * @function AddClasses
    * @param {String[]} classes
    */
    function AddClasses(classes){
        _table.CssClass = ( ( !_table.CssClass ) ? "" : (_table.CssClass + " " ) ) + classes.join(" ");
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @private
     * @function _getSumOfCells
     * @description function to get formula expression for sum of previous columns
     * @param {Number} cellsNumber
     * @param {Number} offset
     * @returns {String}
     */
    private function _getSumOfCells(cellsNumber,offset){
        var cellsSum;
        var cellsValues = [];
        var columnNumber;
        for( var i = 1; i &lt;= cellsNumber; i++){
            columnNumber = i + ( offset ? offset : 0);
            cellsValues.push(("IF(cellv(col-"+columnNumber+",row) = EMPTYV(), 0, cellv(col-"+columnNumber+",row))"));
        }

        cellsSum = "IF(("+cellsValues.join('+')+") = 0, EMPTYV(), "+cellsValues.join('+')+")"
        return cellsSum
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function GetCategoriesHeader
     * @description function to get columnHeader for total or neg, neu, pos categories
     * @param {String} groupName - "total", "neg", "neu","pos"
     * @param {Boolean} addMinus - if you want to add minus to negative values
     * @param {Boolean} hideHeader
     * @param {String} distribution - 0 - for counts, 1 - for percents
     * @returns {HeaderCollection}
     */
    function GetCategoriesHeader(groupName: String, addMinus, hideHeader, distribution){
        var header: HeaderCollection = new HeaderCollection();
        var headerFormula : HeaderFormula;
        var headerCategories: HeaderCategories;
        var categoryTitle: Label;
        if( groupName == "all" ){
            headerCategories= new HeaderCategories();
            headerCategories.Mask.Type = MaskType.HideAll;
            headerCategories.Totals = true;

            headerCategories.HideHeader = hideHeader ? hideHeader : false;
            header.Add(headerCategories);

        }else{

            headerCategories= new HeaderCategories();
            headerCategories.Mask.Type = MaskType.ShowCodes;
            headerCategories.Totals = false;
            headerCategories.HideData = true;


            headerFormula = new HeaderFormula();
            headerFormula.Type = FormulaType.Expression;
            headerFormula.Decimals = 0;
            headerFormula.Priority = 0;

            switch(groupName.toLowerCase()){
                case "neg":
                    headerCategories.Mask.Codes = Config.SentimentRange.Negative.join(",");
                    headerFormula.Expression = _getSumOfCells(4)+(addMinus?"*(-1)":"");
                    categoryTitle = new Label(9, "Negative");
                    break;

                case "neu":
                    headerCategories.Mask.Codes = Config.SentimentRange.Neutral.join(",");
                    headerFormula.Expression = _getSumOfCells(3);
                    categoryTitle = new Label(9, "Neutral");
                    break;

                case "pos":
                    headerCategories.Mask.Codes = Config.SentimentRange.Positive.join(",");
                    headerFormula.Expression = _getSumOfCells(4);
                    categoryTitle = new Label(9, "Positive");
                    break;
            }


            headerFormula.Title = categoryTitle;

            headerFormula.HideHeader = hideHeader ? hideHeader : false;

            if(distribution &amp;&amp; distribution == "1"){
                headerCategories.Distributions.Enabled = true;
                headerCategories.Distributions.Count = false;
                headerCategories.Distributions.HorizontalPercents = true;
                headerFormula.Expression +="/100";
                headerFormula.Percent = true;
            }
            header.Add(headerCategories);
            header.Add(headerFormula);
        }
        return header
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function GetCategoriesExpression
     * @description function to get columnHeaderExpression for total or neg, neu, pos categories
     * @param {String} groupName - "total", "neg", "neu","pos"
     * @param {Boolean} addMinus - if you want to add minus to negative values
     * @param {Boolean} hideHeader
     * @param {String} distribution - 0 - for counts, 1 - for percents
     * @returns {String}
     */
    function GetCategoriesExpression( groupName: String, addMinus, hideHeader, distribution ){
        var expression = "";
        if( groupName == "all" ){
            expression = '[CAT]{totals:true';
            expression += ';mask:emptyv';
            if ( hideHeader )
                expression += ';hideheader:true';
            expression += '}'
        }else{
            var categoriesHeader = '[CAT]{totals:false;hidedata:true';
            var formulaHeader = '[FORMULA]{decimals:0';
            var formulaExpression;
            var categoryLabel;
            switch(groupName.toLowerCase()){
                case "neg":
                    formulaExpression = _getSumOfCells(4,7)+(addMinus?'*(-1)':'');
                    categoryLabel = '"Negative"';
                    break;

                case "neu":
                    formulaExpression = _getSumOfCells(3,4);
                    categoryLabel = '"Neutral"';
                    break;

                case "pos":
                    formulaExpression = _getSumOfCells(4,0);
                    categoryLabel = '"Positive"';
                    break;
            }

            if(distribution &amp;&amp; distribution == "1"){
                formulaExpression +="/100";
                formulaHeader += ";percent:true";
            }

            formulaHeader += ';label:'+categoryLabel+';expression:"'+formulaExpression+'"';

            if ( hideHeader )
                formulaHeader += ';hideheader:true';
            formulaHeader +='}'
            categoriesHeader += "}"
            expression = [categoriesHeader, formulaHeader].join("+")
        }
        return expression
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function GetChartHeader
     * @description function to get Header containing Barchart
     * @param {ChartComboType} type
     * @param {Object[]} formulas - array of objects with formulas like {Formula: "cellv(col-25,row)", Color: (Config.Colors.NegNeuPosPalette.Positive)}
     * @param {String} title
     * @returns {HeaderChartCombo}
     */
    function GetChartHeader(type: ChartComboType, formulas, title){
        var chartHeader: HeaderChartCombo = new HeaderChartCombo();
        var chartValues = []
        chartHeader.TypeOfChart = type;
        chartHeader.Thickness = "80%";
        chartHeader.CssClass = "chart-header";
        chartHeader.ShowTitle = true;
        chartHeader.Title = new Label(9, title?title:"Chart");

        var chartValue: ChartComboValue;
        for(var i = 0; i&lt; formulas.length; i++) {
            chartValue = new ChartComboValue();
            chartValue.CssClass = "chart-value";
            chartValue.Expression = formulas[i].Formula;
            chartValue.BaseColor = new ChartComboColorSet([formulas[i].Color]);
            chartValues.push(chartValue);
        }

        chartHeader.Values = chartValues;
        return chartHeader;
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function GetTAQuestionExpression
     * @description function to get Expression for header containing Text Analytics variable
     * @param {String} questionType - "overallsentiment", "categories", "positivementions", "negativementions", "categorysentiment"
     * @param {String[]} mask
     * @param {String} additionalStatement
     * @returns {String}
     */
    function GetTAQuestionExpression(questionType, mask, additionalStatement){
        var rowExpression;
        var variableId = _folder.GetQuestionId(questionType);
        rowExpression = variableId+'{id:'+variableId+';collapsed:true;totals:false'+( mask &amp;&amp; mask.length > 0 ? (';mask:'+mask.join(",")) : null )+( additionalStatement ? (";"+additionalStatement) : null)+'}';
        return rowExpression
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function GetTimePeriodHeader
     * @description function to get Header for certain time period
     * @param {String} unit - breaking by  "d" - for days, "w" - for weeks, "m" - for months, "q" - for quarters, "y" - for years
     * @param {Number} from - rolling from
     * @param {Number} to - rolling to
     * @returns {HeaderQuestion}
     */
    function GetTimePeriodHeader(unit, from, to){
        var project = _globals.report.DataSource.GetProject(_folder.GetDatasourceId());
        var questionnaireElement: QuestionnaireElement = project.CreateQuestionnaireElement(_folder.GetTimeVariableId());
        var headerTimeSeries: HeaderQuestion;

        headerTimeSeries = new HeaderQuestion(questionnaireElement);
        headerTimeSeries.TimeSeries.FlatLayout = true;
        headerTimeSeries.TimeSeries.RollingTimeseries.Enabled = true;

        headerTimeSeries.TimeSeries.Time1 = TimeseriesTimeUnitType.Year;
        switch (unit.toLowerCase()){
            case "d":
                headerTimeSeries.TimeSeries.Time2 = TimeseriesTimeUnitType.Month;
                headerTimeSeries.TimeSeries.Time3 = TimeseriesTimeUnitType.DayOfMonth;
                headerTimeSeries.TimeSeries.RollingTimeseries.Unit = RollingUnitType.Day;
                break;
            case "w":
                headerTimeSeries.TimeSeries.Time2 = TimeseriesTimeUnitType.Week;
                headerTimeSeries.TimeSeries.RollingTimeseries.Unit = RollingUnitType.Week;
                break;
            case "m":
                headerTimeSeries.TimeSeries.Time2 = TimeseriesTimeUnitType.Month
                headerTimeSeries.TimeSeries.RollingTimeseries.Unit = RollingUnitType.Month;;
                break;
            case "q":
                headerTimeSeries.TimeSeries.Time2 = TimeseriesTimeUnitType.Quarter
                headerTimeSeries.TimeSeries.RollingTimeseries.Unit = RollingUnitType.Quarter;
                break;
            case "y":
            default:
                headerTimeSeries.TimeSeries.RollingTimeseries.Unit = RollingUnitType.Year;
                break;
        }
        headerTimeSeries.ShowTotals = false;
        headerTimeSeries.TimeSeries.RollingTimeseries.From = from;
        headerTimeSeries.TimeSeries.RollingTimeseries.To = to;

        return headerTimeSeries
    }

    /**
     * @memberof TATableUtils
     * @instance
     * @function CreateTableFromExpression
     * @description function to create table from columns and rows expression
     * @param {String} rowHeaders
     * @param {String} columnHeaders
     */
    function CreateTableFromExpression(rowHeaders, columnHeaders){
        var headersArray = [rowHeaders];
        if( columnHeaders ){
            headersArray.push( columnHeaders )
        }
        var tableExpression = headersArray.join('^');
        _table.AddHeaders(_globals.report, Config.DS_Main, tableExpression);
    }
}</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Fri Sep 02 2016 16:23:27 GMT+0300 (Russia TZ 2 Standard Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
